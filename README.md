# 🧪 LG Aimers 5기 - 제품 이상 판별 AI 모델 개발


## 소개

LG AI 해커톤 Aimers 5기에서 진행한 **제품 이상 판별 AI 모델 개발 프로젝트**입니다.  
고차원 structured 데이터를 다루는 상황에서 **차원 축소**, **피처 엔지니어링**, **불균형 대응**,  
**앙상블 모델링** 등 다양한 머신러닝 기법을 적용하여 **제품 이상 여부를 예측**하는 모델을 개발했습니다.


## 🗂 프로젝트 개요

- **프로젝트명**: LG Aimers 5기 제품 이상 판별 프로젝트  
- **진행 기간**: 2024.07.01 ~ 2024.08.27 
- **참가 규모**: 1,400팀  넘었는데
- **최종 성과**:  
  - Public Score 기준: **160위**  
  - Final Leaderboard 기준: **84위**

- **역할**:
  - 데이터 정제 및 탐색 (EDA)  
  - 변수 간 관계 해석 및 고차원 피처 설계  
  - 모델링, 튜닝, 앙상블 전략 수립 및 구현


## 🔍 데이터 분석 및 설계 상 주요 고민

- **정보량이 거의 없는 칼럼의 선별과 제거**:  
  모두가 같은 값만 가지거나 의미가 없는 변수들(`Wip Line_Dam`, `Process Desc._Dam` 등)을  
  value_counts와 set 분석을 통해 제거했습니다.

- **중복 정보가 포함된 변수 간 관계 제거**:  
  서로 다른 칼럼이지만 값이 연동되어 실질적으로 같은 정보를 담고 있는 **의미 중복 컬럼**들이 존재했고,  
  그 중 많은 경우를 **직접 논리적으로 대응 관계를 확인하며 제거**하였습니다.

- **좌표형 변수 축소**:  
  X, Y, Z 세 방향의 좌표를  **세 좌표 간 유클리드 거리로 환산**하여 **정보 손실 없이 변수 수를 축소**하고자 했습니다.

- **카테고리형 변수 인코딩 설계**:  
  `Equipment_Dam`, `Model.Suffix_Dam`, `Workorder_Dam` 등 명목형 변수는  
  label encoding 또는 target encoding 방식으로 적용하였습니다.

- **데이터 밀림 처리**:  
  일부 행들이 **정렬 순서를 벗어나거나**, 다른 대상의 정보가 섞인 것으로 보이는 경우가 있었고,  
  이들을 직접 탐지하고 수정하여 **데이터 순서 및 대응 정확도 확보**에 중점을 두었습니다.

- **도메인 지식 부족으로 인한 변수 해석 난이도**:  
  제조 도메인에 대한 이해가 부족한 상태에서 시작했기 때문에  
  변수의 이름과 분포를 토대로 **각 변수 간의 관계와 의미를 유추**하는 데 많은 시간을 들였으며,  
  group별 특성과 feature importance를 함께 고려해 feature 설계를 진행했습니다.


## 🧪 데이터 전처리 및 피처 엔지니어링

- **결측 및 이상치 처리**:  
  - NaN 비율이 높은 컬럼 제거 또는 보간  
  - 단일값 반복되는 변수 제거  
  - 범주형 컬럼의 label encoding 및 frequency encoding

- **수치형 피처 축소**:  
  - PCA를 통한 차원 축소  
  - Feature importance 기반 선택적 feature 제거  
  - 상관관계 분석으로 중복 피처 필터링

- **정규화 및 스케일링**:  
  - MinMaxScaler, RobustScaler 등 다양한 방법 실험  
  - 이상치 영향을 최소화하는 방식 적용


## 🤖 모델 개발 및 최적화

- **사용 모델**:
    - XGBoost: 국밥 모델은 Optuna로 튜닝했을 때 가장 성능이 뛰어났고, 최종 앙상블 중심 모델로 활용했습니다.
    - LightGBM: 빠른 학습 속도와 안정적인 결과를 보여 baseline으로 적합했습니다. Precision과 Recall 간의 균형도 뛰어났습니다.
    - CatBoost: 범주형 변수에 강점을 가지나, 해당 데이터셋에서는 큰 이점을 보이진 않았습니다.
    - RandomForest: baseline 비교용으로 사용했으며, 단순하게 카테고리 변수만을 사용한 실험에서도 비교적 준수한 성능을 보였습니다.
- **불균형 대응**:
    - Undersampling / Oversampling
    - `scale_pos_weight`, class weighting 등 다양한 방식 실험
- **앙상블 전략**:
    - Hard, Soft Voting 기반의 앙상블을 실험했고, 각각의 결과를 비교하여 성능이 가장 좋은 방식으로 최종 제출하였습니다.
- **튜닝 도구**:
    - Optuna를 통한 자동화 기반 하이퍼파라미터 최적화
    - 모델별 특성과 데이터셋의 특이성을 고려하여 조정
- **실험 중 고려 사항**:
    
    첫 모델링 대회 참여였기에~~ 다양한 시도를 통해 모델간 특성과 효용을 파악하고자 했습니다.
    
    특히 범주형 변수가 강한 신호를 가질 수 있다는 점에서 **카테고리 변수만으로 구성된 간단한 모델 실험도 진행**하였고, 예상보다 괜찮은 결과를 보여 도메인 해석 측면에서의 한계를 느꼈습니다.
    

---

## ✅ 주요 성과 및 인사이트

- 중복 정보 제거 및 좌표 기반 feature 단순화를 통해 **모델 복잡도 감소**
- 다양한 tree 기반 모델의 앙상블로 **일관된 성능 확보**
- 불균형 데이터 대응 전략과 Optuna 튜닝을 통해 **overfitting 최소화**
- **전반적으로 낮은 분류 성능 구조에 대한 원인 가설 수립**
    
    리더보드 상위권의 F1 score가 0.1대에 머무는 등 이진 분류임에도 예측 성능이 낮게 나왔고,,,
    
    이를 통해 다음과 같은 가설을 세움:
    
    ① **변수 수가 과도하게 많아 모델이 분산됨** (약 460개 수준)
    
    ② **제조 공정 특성상 매우 미세한 차이로도 양/음량이 갈림**
    
    이를 바탕으로 feature selection, PCA 기반 차원 축소, 좌표 데이터 통합(유클리드 거리 계산) 등 **모델의 일반화 성능을 높이기 위한 구조적 접근**을 실험함
    
- **분석 초반, 카테고리형 변수 탐색의 중요성 인식**
    
    첫 모델링 대회 참여였는데, 해보며 깨달은 점은..
    
    수치형 변수보다 **카테고리형 변수를 먼저 탐색**하는 것이 직관적이고 효율적이라는 점
    
    특히 groupby 기반 분포 파악과 파생 변수 설계에 유리하여, feature engineering의 시작점으로 적합했음
    

---

## 📝 아쉬운 점

- **시계열 기반 특성 반영 부족**:
    
    공정 단계나 시간 흐름에 따른 순서를 더 반영한 feature 설계가 부족했음
    
    시간 정보 기반 LSTM 등 시계열 모델을 추가로 실험하지 못한 점이 아쉬움
    
- **도메인 해석의 한계**:
    
    제조 공정과 장비 특성에 대한 지식이 부족해, 변수 간 관계나 의미 해석에 많은 시간이 소요되었고 일부 변수는 의미 기반 활용이 어려웠음
    
- **이상탐지 기법 활용 미흡**:
    
    Isolation Forest, One-Class SVM 등 이상탐지 중심의 모델 활용까지는 실험하지 못했음
    
- **결측 처리 방식 단순화**:
    
    평균/최빈값 대체 또는 단순 보간 방식만 사용하였고, 더 정교한 결측 처리 기법을 적용하지 못함
    
- **row-level 정제 부족**:
    
    column 단위의 feature selection 중심으로 진행하였으나,
    
    이상한 row를를 제거하거나 정제하는 실험도 병행했더라면 noise 제거에 효과가 있었을 것으로 이제와서 생각이 든다는 점 ..
